<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil Usuario</title>
    <link rel="stylesheet" href="../css/perfile.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- FontAwesome -->
    <script src="https://kit.fontawesome.com/c4033be41c.js" crossorigin="anonymous"></script>

    <!-- SweetAlert2 para notificaciones elegantes -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <div id="header"></div>
    <script src="../Js/dinav.js"></script>

    <main class="container mt-5">
        <h1 class="text-center">Perfil del Usuario</h1>
        <div class="profile-container formaCo d-flex flex-wrap justify-content-center gap-4">
            <!-- Foto del Administrador -->
            <div class="card text-center p-3" style="width: 18rem;">
                <img id="photo" class="card-img-top rounded-circle" src="" alt="Foto del Administrador">
                <div class="card-body">
                    <h5 class="card-title" id="fullName">Cargando...</h5>
                    <p class="card-text text-muted" id="role">Cargando...</p>
                </div>
            </div>
            <!-- Información del Perfil -->
            <div class="card p-4" style="width: 18rem;">
                <label for="id"><strong>Cedula:</strong></label>
                <input type="text" id="id" class="form-control mb-3" readonly>
                <label for="email"><strong>Correo Electrónico:</strong></label>
                <input type="email" id="email" class="form-control mb-3" readonly>
                <label for="phone"><strong>Teléfono:</strong></label>
                <input type="text" id="phone" class="form-control" readonly>
            </div>
        </div>

        <!-- Acciones del Usuario -->
        <section class="mt-5">
            <h2 class="text-center mb-4">Acciones</h2>
            <div class="d-flex flex-wrap justify-content-center gap-4">
                <a href="CoursesEnrolled.html" class="btn btn-primary d-flex align-items-center gap-2">
                    <i class="fa-solid fa-book"></i> Cursos Inscritos
                </a>
                <a href="#" class="btn btn-warning d-flex align-items-center gap-2" data-bs-toggle="modal"
                    data-bs-target="#editProfileModal">
                    <i class="fa-solid fa-user-pen"></i> Editar Perfil
                </a>
                <button onclick="handleLogout()" class="btn btn-danger d-flex align-items-center gap-2">
                    <i class="fa-solid fa-right-from-bracket"></i> Cerrar Sesión
                </button>
            </div>
        </section>
    </main>
    <!-- Modal para Editar Perfil -->
    <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editProfileModalLabel">Editar Perfil</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Formulario de edición del perfil -->
                    <form id="editProfileForm">
                        <div class="mb-3">
                            <label for="editFullName" class="form-label">Nombre Completo</label>
                            <input type="text" class="form-control" id="editFullName" required>
                        </div>
                        <div class="mb-3">
                            <label for="editEmail" class="form-label">Correo Electrónico</label>
                            <input type="email" class="form-control" id="editEmail" required>
                        </div>
                        <div class="mb-3">
                            <label for="editPhone" class="form-label">Teléfono</label>
                            <input type="text" class="form-control" id="editPhone" required>
                        </div>
                        <div class="mb-3">
                            <label for="editImage" class="form-label">Imagen de Perfil</label>
                            <input type="file" class="form-control" id="editImage" accept="image/png, image/jpeg">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveChangesBtn">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const modalElement = document.querySelector("#editProfileModal");
            if (!modalElement) {
                console.error("El modal no está presente en el DOM.");
            } else {
                console.log("El modal se detectó correctamente en el DOM.");
            }
        });
        document.addEventListener("DOMContentLoaded", () => {
            const editProfileModal = document.getElementById("editProfileModal");
            if (editProfileModal) {
                editProfileModal.addEventListener("show.bs.modal", () => {
                    // Carga de datos
                    const fullName = document.getElementById("fullName").textContent;
                    const email = document.getElementById("email").value;
                    const phone = document.getElementById("phone").value;
                    const photoSrc = document.getElementById("photo").src;

                    // Actualizar campos del modal
                    document.getElementById("editFullName").value = fullName;
                    document.getElementById("editEmail").value = email;
                    document.getElementById("editPhone").value = phone;
                    document.getElementById("previewImage").src = photoSrc;
                });
            } else {
                console.error("Modal no encontrado.");
            }
        });

    </script>
    <!-- Scripts -->
    <script src="../Js/loadData.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-skDk8zhD9JNG0c/uzXazMb/rC2QYVzkeaqOmX7kzPw5IrDfOeQmUdx9fqRAhQ/RR" crossorigin="anonymous">
        </script>
    <div id="footer"></div>
</body>

</html>